{
"version":3,
"file":"goog.net.bulkloader.js",
"lineCount":68,
"mappings":"AAoBAA,IAAAC,QAAA,CAAa,qBAAb,CAAA;AAEAD,IAAAE,QAAA,CAAa,mBAAb,CAAA;AACAF,IAAAE,QAAA,CAAa,0BAAb,CAAA;AACAF,IAAAE,QAAA,CAAa,yBAAb,CAAA;AACAF,IAAAE,QAAA,CAAa,UAAb,CAAA;AACAF,IAAAE,QAAA,CAAa,2BAAb,CAAA;AACAF,IAAAE,QAAA,CAAa,oBAAb,CAAA;AACAF,IAAAE,QAAA,CAAa,gBAAb,CAAA;AAWAF,IAAAG,IAAAC,WAAA,GAAsBC,QAAQ,CAACC,IAAD,CAAO;AACnCN,MAAAO,OAAAC,YAAAC,KAAA,CAA6B,IAA7B,CAAA;AAOA,MAAAC,QAAA,GAAe,IAAIV,IAAAG,IAAAQ,iBAAJ,CAA8BL,IAA9B,CAAf;AAOA,MAAAM,cAAA,GAAqB,IAAIZ,IAAAO,OAAAM,aAAJ,CAA6B,IAA7B,CAArB;AAfmC,CAArC;AAiBAb,IAAAc,SAAA,CAAcd,IAAAG,IAAAC,WAAd,EAAmCJ,IAAAO,OAAAC,YAAnC,CAAA;AAQAR,IAAAG,IAAAC,WAAAW,UAAAC,QAAA,GACIhB,IAAAiB,IAAAC,UAAA,CAAmB,qBAAnB,CADJ;AAQAlB,IAAAG,IAAAC,WAAAW,UAAAI,iBAAA,GAAiDC,QAAQ,EAAG;AAC1D,SAAO,IAAAV,QAAAS,iBAAA,EAAP;AAD0D,CAA5D;AASAnB,IAAAG,IAAAC,WAAAW,UAAAM,eAAA,GAA+CC,QAAQ,EAAG;AACxD,SAAO,IAAAZ,QAAAa,QAAA,EAAP;AADwD,CAA1D;AAQAvB,IAAAG,IAAAC,WAAAW,UAAAS,KAAA,GAAqCC,QAAQ,EAAG;AAC9C,MAAIC,eAAe,IAAAd,cAAnB;AACA,MAAIN,OAAO,IAAAI,QAAAa,QAAA,EAAX;AACAvB,MAAAiB,IAAAU,KAAA,CACI,IAAAX,QADJ,EACkB,6BADlB,GACkDV,IAAAsB,OADlD,GACgE,QADhE,CAAA;AAGA,OAAK,IAAIC,IAAI,CAAb,EAAgBA,CAAhB,GAAoBvB,IAAAsB,OAApB,EAAiCC,CAAA,EAAjC,CAAsC;AACpC,QAAIC,QAAQ,IAAI9B,IAAAG,IAAA4B,MAAhB;AACAL,gBAAAM,OAAA,CACIF,KADJ,EACW9B,IAAAG,IAAA8B,UAAAC,SADX,EAEIlC,IAAAmC,KAAA,CAAU,IAAAC,aAAV,EAA6B,IAA7B,EAAmCP,CAAnC,CAFJ,CAAA;AAIAC,SAAAO,KAAA,CAAW/B,IAAA,CAAKuB,CAAL,CAAX,CAAA;AANoC;AANQ,CAAhD;AAuBA7B,IAAAG,IAAAC,WAAAW,UAAAqB,aAAA,GAA6CE,QAAQ,CAACC,EAAD,EAAKC,CAAL,CAAQ;AAC3DxC,MAAAiB,IAAAU,KAAA,CACI,IAAAX,QADJ,EACkB,kBADlB,GACuCwB,CAAAC,KADvC,GACgD,WADhD,GAC8DF,EAD9D,GAEQ,YAFR,GAEuB,IAAA7B,QAAAgC,OAAA,CAAoBH,EAApB,CAFvB,CAAA;AAGA,MAAIT,QAAuCU,CAAAG,OAA3C;AACA,MAAIb,KAAAc,UAAA,EAAJ;AACE,QAAAC,eAAA,CAAoBN,EAApB,EAAwBT,KAAxB,CAAA;AADF;AAGE,QAAAgB,aAAA,CAAkBP,EAAlB,EAAsBT,KAAtB,CAAA;AAHF;AAL2D,CAA7D;AAoBA9B,IAAAG,IAAAC,WAAAW,UAAA8B,eAAA,GAA+CE,QAAQ,CAACR,EAAD,EAAKT,KAAL,CAAY;AAEjE,MAAApB,QAAAsC,gBAAA,CAA6BT,EAA7B,EAAiCT,KAAAmB,gBAAA,EAAjC,CAAA;AAGA,MAAI,IAAAvC,QAAAwC,eAAA,EAAJ;AACE,QAAAC,YAAA,EAAA;AADF;AAGArB,OAAAsB,QAAA,EAAA;AARiE,CAAnE;AAmBApD,IAAAG,IAAAC,WAAAW,UAAA+B,aAAA,GAA6CO,QAAQ,CAACd,EAAD,EAAKT,KAAL,CAAY;AAI/D,MAAAwB,cAAA,CAAmB,IAAItD,IAAAG,IAAAC,WAAAmD,eAAJ,CAAuCzB,KAAA0B,UAAA,EAAvC,CAAnB,CAAA;AACA1B,OAAAsB,QAAA,EAAA;AAL+D,CAAjE;AAaApD,IAAAG,IAAAC,WAAAW,UAAAoC,YAAA,GAA4CM,QAAQ,EAAG;AACrDzD,MAAAiB,IAAAU,KAAA,CAAc,IAAAX,QAAd,EAA4B,kBAA5B,CAAA;AAGA,MAAAsC,cAAA,CAAmBtD,IAAAG,IAAA8B,UAAAyB,QAAnB,CAAA;AAJqD,CAAvD;AASA1D,IAAAG,IAAAC,WAAAW,UAAA4C,gBAAA,GAAgDC,QAAQ,EAAG;AACzD5D,MAAAG,IAAAC,WAAAyD,YAAAF,gBAAAlD,KAAA,CAAqD,IAArD,CAAA;AAEA,MAAAG,cAAAwC,QAAA,EAAA;AACA,MAAAxC,cAAA,GAAqB,IAArB;AAEA,MAAAF,QAAA0C,QAAA,EAAA;AACA,MAAA1C,QAAA,GAAe,IAAf;AAPyD,CAA3D;AAkBAV,IAAAG,IAAAC,WAAAmD,eAAA,GAAqCO,QAAQ,CAACC,MAAD,CAAS;AACpD/D,MAAAG,IAAAC,WAAAmD,eAAAS,KAAA,CACI,IADJ,EACU,aADV,EACyBhE,IAAAG,IAAA8B,UAAAgC,MADzB,CAAA;AAIA,MAAAF,OAAA,GAAcA,MAAd;AALoD,CAAtD;AAOA/D,IAAAc,SAAA,CAAcd,IAAAG,IAAAC,WAAAmD,eAAd,EAAkDvD,IAAAO,OAAA2D,MAAlD,CAAA;;",
"sources":["goog/net/bulkloader.js"],
"sourcesContent":["// Copyright 2008 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Loads a list of URIs in bulk. All requests must be a success\n * in order for the load to be considered a success.\n *\n */\n\ngoog.provide('goog.net.BulkLoader');\n\ngoog.require('goog.events.Event');\ngoog.require('goog.events.EventHandler');\ngoog.require('goog.events.EventTarget');\ngoog.require('goog.log');\ngoog.require('goog.net.BulkLoaderHelper');\ngoog.require('goog.net.EventType');\ngoog.require('goog.net.XhrIo');\n\n\n\n/**\n * Class used to load multiple URIs.\n * @param {Array<string|goog.Uri>} uris The URIs to load.\n * @constructor\n * @extends {goog.events.EventTarget}\n * @final\n */\ngoog.net.BulkLoader = function(uris) {\n  goog.events.EventTarget.call(this);\n\n  /**\n   * The bulk loader helper.\n   * @type {goog.net.BulkLoaderHelper}\n   * @private\n   */\n  this.helper_ = new goog.net.BulkLoaderHelper(uris);\n\n  /**\n   * The handler for managing events.\n   * @type {goog.events.EventHandler<!goog.net.BulkLoader>}\n   * @private\n   */\n  this.eventHandler_ = new goog.events.EventHandler(this);\n};\ngoog.inherits(goog.net.BulkLoader, goog.events.EventTarget);\n\n\n/**\n * A logger.\n * @type {goog.log.Logger}\n * @private\n */\ngoog.net.BulkLoader.prototype.logger_ =\n    goog.log.getLogger('goog.net.BulkLoader');\n\n\n/**\n * Gets the response texts, in order.\n * @return {Array<string>} The response texts.\n */\ngoog.net.BulkLoader.prototype.getResponseTexts = function() {\n  return this.helper_.getResponseTexts();\n};\n\n\n/**\n * Gets the request Uris.\n * @return {Array<string>} The request URIs, in order.\n */\ngoog.net.BulkLoader.prototype.getRequestUris = function() {\n  return this.helper_.getUris();\n};\n\n\n/**\n * Starts the process of loading the URIs.\n */\ngoog.net.BulkLoader.prototype.load = function() {\n  var eventHandler = this.eventHandler_;\n  var uris = this.helper_.getUris();\n  goog.log.info(\n      this.logger_, 'Starting load of code with ' + uris.length + ' uris.');\n\n  for (var i = 0; i < uris.length; i++) {\n    var xhrIo = new goog.net.XhrIo();\n    eventHandler.listen(\n        xhrIo, goog.net.EventType.COMPLETE,\n        goog.bind(this.handleEvent_, this, i));\n\n    xhrIo.send(uris[i]);\n  }\n};\n\n\n/**\n * Handles all events fired by the XhrManager.\n * @param {number} id The id of the request.\n * @param {goog.events.Event} e The event.\n * @private\n */\ngoog.net.BulkLoader.prototype.handleEvent_ = function(id, e) {\n  goog.log.info(\n      this.logger_, 'Received event \"' + e.type + '\" for id ' + id +\n          ' with uri ' + this.helper_.getUri(id));\n  var xhrIo = /** @type {goog.net.XhrIo} */ (e.target);\n  if (xhrIo.isSuccess()) {\n    this.handleSuccess_(id, xhrIo);\n  } else {\n    this.handleError_(id, xhrIo);\n  }\n};\n\n\n/**\n * Handles when a request is successful (i.e., completed and response received).\n * Stores thhe responseText and checks if loading is complete.\n * @param {number} id The id of the request.\n * @param {goog.net.XhrIo} xhrIo The XhrIo objects that was used.\n * @private\n */\ngoog.net.BulkLoader.prototype.handleSuccess_ = function(id, xhrIo) {\n  // Save the response text.\n  this.helper_.setResponseText(id, xhrIo.getResponseText());\n\n  // Check if all response texts have been received.\n  if (this.helper_.isLoadComplete()) {\n    this.finishLoad_();\n  }\n  xhrIo.dispose();\n};\n\n\n/**\n * Handles when a request has ended in error (i.e., all retries completed and\n * none were successful). Cancels loading of the URI's.\n * @param {number|string} id The id of the request.\n * @param {goog.net.XhrIo} xhrIo The XhrIo objects that was used.\n * @private\n */\ngoog.net.BulkLoader.prototype.handleError_ = function(id, xhrIo) {\n  // TODO(user): Abort all pending requests.\n\n  // Dispatch the ERROR event.\n  this.dispatchEvent(new goog.net.BulkLoader.LoadErrorEvent(xhrIo.getStatus()));\n  xhrIo.dispose();\n};\n\n\n/**\n * Finishes the load of the URI's. Dispatches the SUCCESS event.\n * @private\n */\ngoog.net.BulkLoader.prototype.finishLoad_ = function() {\n  goog.log.info(this.logger_, 'All uris loaded.');\n\n  // Dispatch the SUCCESS event.\n  this.dispatchEvent(goog.net.EventType.SUCCESS);\n};\n\n\n/** @override */\ngoog.net.BulkLoader.prototype.disposeInternal = function() {\n  goog.net.BulkLoader.superClass_.disposeInternal.call(this);\n\n  this.eventHandler_.dispose();\n  this.eventHandler_ = null;\n\n  this.helper_.dispose();\n  this.helper_ = null;\n};\n\n\n/**\n * @param {number} status The response status.\n * @constructor\n * @extends {goog.events.Event}\n * @final\n * @protected\n */\ngoog.net.BulkLoader.LoadErrorEvent = function(status) {\n  goog.net.BulkLoader.LoadErrorEvent.base(\n      this, 'constructor', goog.net.EventType.ERROR);\n\n  /** @type {number} */\n  this.status = status;\n};\ngoog.inherits(goog.net.BulkLoader.LoadErrorEvent, goog.events.Event);\n"],
"names":["goog","provide","require","net","BulkLoader","goog.net.BulkLoader","uris","events","EventTarget","call","helper_","BulkLoaderHelper","eventHandler_","EventHandler","inherits","prototype","logger_","log","getLogger","getResponseTexts","goog.net.BulkLoader.prototype.getResponseTexts","getRequestUris","goog.net.BulkLoader.prototype.getRequestUris","getUris","load","goog.net.BulkLoader.prototype.load","eventHandler","info","length","i","xhrIo","XhrIo","listen","EventType","COMPLETE","bind","handleEvent_","send","goog.net.BulkLoader.prototype.handleEvent_","id","e","type","getUri","target","isSuccess","handleSuccess_","handleError_","goog.net.BulkLoader.prototype.handleSuccess_","setResponseText","getResponseText","isLoadComplete","finishLoad_","dispose","goog.net.BulkLoader.prototype.handleError_","dispatchEvent","LoadErrorEvent","getStatus","goog.net.BulkLoader.prototype.finishLoad_","SUCCESS","disposeInternal","goog.net.BulkLoader.prototype.disposeInternal","superClass_","goog.net.BulkLoader.LoadErrorEvent","status","base","ERROR","Event"]
}
